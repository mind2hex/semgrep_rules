rules:
  - id: json-pattern-009-Sensitive-Information-in-Source-Code
    languages:
      - json
    severity: INFO
    message: The source code repository contains sensitive information such as
      usernames, passwords, email addresses and IP addresses, among others.
      Alternatively, while values may be password=123 o aws.secret_key=test,
      they reveal the bad practice of storing sensitive information in the
      repository with no encryption, and sooner or later they can be replaced
      for real sensitive values.
    pattern-either:
      # google cloud platform credentials [IMPORTANT]
      - pattern-either:
        - pattern: |
            "client_email": ...
        - pattern: |
            "client_secret": ...
        - pattern: |
            "client_id": ...
        - pattern: |
            "private_key": ...
        - pattern: |
            "private_key_id": ...
        - pattern: |
            "project_id": ...
    
      # AWS CREDENTIALS
      - pattern-either:
        - pattern: |
            "aws_access_key_id": ...
        - pattern: |
            "aws_secret_access_key": ...
        - pattern: |
            "aws_session_token": ...
        - pattern: |
            "accessKeyId": ...
        - pattern: |
            "secretAccessKey": ...
        - pattern: |
            "sessionToken": ...

      # AZURE CREDENTIALS
      - pattern-either:
        - pattern: |
            "azure_client_id": ...
        - pattern: |
            "azure_client_secret": ...
        - pattern: |
            "azure_tenant_id": ...
        - pattern: |
            "azure_subscription_id": ...
        - pattern: |
            "AZURE_CLIENT_SECRET": ...
      
      # DigitalOcean
      - pattern-either:
        - pattern: |
            "digitalocean_token": ...
        - pattern: |
            "do_api_token": ...

      # Heroku
      - pattern-either:
        - pattern: |
            "heroku_api_key": ...
        - pattern: |
            "HEROKU_API_KEY": ...

      # ==================== AUTHENTICATION ====================
      
      # Generic passwords
      - pattern-either:
        - pattern: |
            "password": ...
        - pattern: |
            "passwd": ...
        - pattern: |
            "pwd": ...
        - pattern: |
            "user_password": ...
        - pattern: |
            "userPassword": ...
        - pattern: |
            "admin_password": ...
        - pattern: |
            "adminPassword": ...
      
      # API Keys
      - pattern-either:
        - pattern: |
            "api_key": ...
        - pattern: |
            "apiKey": ...
        - pattern: |
            "apikey": ...
        - pattern: |
            "api-key": ...
        - pattern: |
            "API_KEY": ...
        - pattern: |
            "x-api-key": ...
      
      # Access Keys
      - pattern-either:
        - pattern: |
            "access_key": ...
        - pattern: |
            "accessKey": ...
        - pattern: |
            "access-key": ...
        - pattern: |
            "ACCESS_KEY": ...
      
      # Secret Keys
      - pattern-either:
        - pattern: |
            "secret": ...
        - pattern: |
            "secret_key": ...
        - pattern: |
            "secretKey": ...
        - pattern: |
            "secret-key": ...
        - pattern: |
            "SECRET_KEY": ...
        - pattern: |
            "app_secret": ...
        - pattern: |
            "appSecret": ...
      
      # Tokens
      - pattern-either:
        - pattern: |
            "token": ...
        - pattern: |
            "access_token": ...
        - pattern: |
            "accessToken": ...
        - pattern: |
            "auth_token": ...
        - pattern: |
            "authToken": ...
        - pattern: |
            "bearer_token": ...
        - pattern: |
            "bearerToken": ...
        - pattern: |
            "refresh_token": ...
        - pattern: |
            "refreshToken": ...
        - pattern: |
            "jwt_token": ...
        - pattern: |
            "jwtToken": ...
      
      # ==================== DATABASE ====================
      
      # Database passwords
      - pattern-either:
        - pattern: |
            "db_password": ...
        - pattern: |
            "dbPassword": ...
        - pattern: |
            "database_password": ...
        - pattern: |
            "databasePassword": ...
        - pattern: |
            "DB_PASSWORD": ...
      
      # Database URLs/Connection Strings
      - pattern-either:
        - pattern: |
            "database_url": ...
        - pattern: |
            "databaseUrl": ...
        - pattern: |
            "DATABASE_URL": ...
        - pattern: |
            "connection_string": ...
        - pattern: |
            "connectionString": ...
        - pattern: |
            "CONNECTION_STRING": ...
        - pattern: |
            "jdbc_url": ...
        - pattern: |
            "JDBC_URL": ...
      
      # MongoDB
      - pattern-either:
        - pattern: |
            "mongo_uri": ...
        - pattern: |
            "mongoUri": ...
        - pattern: |
            "mongodb_uri": ...
        - pattern: |
            "mongodbUri": ...
        - pattern: |
            "MONGO_URI": ...
        - pattern: |
            "MONGODB_URI": ...
      
      # Redis
      - pattern-either:
        - pattern: |
            "redis_password": ...
        - pattern: |
            "redisPassword": ...
        - pattern: |
            "REDIS_PASSWORD": ...
        - pattern: |
            "redis_url": ...
        - pattern: |
            "REDIS_URL": ...
      
      # ==================== THIRD-PARTY SERVICES ====================
      
      # Stripe
      - pattern-either:
        - pattern: |
            "stripe_secret_key": ...
        - pattern: |
            "stripeSecretKey": ...
        - pattern: |
            "STRIPE_SECRET_KEY": ...
        - pattern: |
            "stripe_api_key": ...
        - pattern: |
            "STRIPE_API_KEY": ...
      
      # Twilio
      - pattern-either:
        - pattern: |
            "twilio_auth_token": ...
        - pattern: |
            "twilioAuthToken": ...
        - pattern: |
            "TWILIO_AUTH_TOKEN": ...
        - pattern: |
            "twilio_api_key": ...
        - pattern: |
            "TWILIO_API_KEY": ...
      
      # SendGrid
      - pattern-either:
        - pattern: |
            "sendgrid_api_key": ...
        - pattern: |
            "sendgridApiKey": ...
        - pattern: |
            "SENDGRID_API_KEY": ...
      
      # Mailgun
      - pattern-either:
        - pattern: |
            "mailgun_api_key": ...
        - pattern: |
            "mailgunApiKey": ...
        - pattern: |
            "MAILGUN_API_KEY": ...
      
      # Slack
      - pattern-either:
        - pattern: |
            "slack_token": ...
        - pattern: |
            "slackToken": ...
        - pattern: |
            "SLACK_TOKEN": ...
        - pattern: |
            "slack_webhook": ...
        - pattern: |
            "slackWebhook": ...
        - pattern: |
            "SLACK_WEBHOOK": ...
        - pattern: |
            "slack_bot_token": ...
        - pattern: |
            "SLACK_BOT_TOKEN": ...
      
      # GitHub
      - pattern-either:
        - pattern: |
            "github_token": ...
        - pattern: |
            "githubToken": ...
        - pattern: |
            "GITHUB_TOKEN": ...
        - pattern: |
            "gh_token": ...
        - pattern: |
            "GH_TOKEN": ...
        - pattern: |
            "github_personal_access_token": ...
      
      # GitLab
      - pattern-either:
        - pattern: |
            "gitlab_token": ...
        - pattern: |
            "gitlabToken": ...
        - pattern: |
            "GITLAB_TOKEN": ...
      
      # Bitbucket
      - pattern-either:
        - pattern: |
            "bitbucket_token": ...
        - pattern: |
            "bitbucketToken": ...
        - pattern: |
            "BITBUCKET_TOKEN": ...
      
      # NPM
      - pattern-either:
        - pattern: |
            "npm_token": ...
        - pattern: |
            "npmToken": ...
        - pattern: |
            "NPM_TOKEN": ...
        - pattern: |
            "_authToken": ...
      
      # Docker
      - pattern-either:
        - pattern: |
            "docker_password": ...
        - pattern: |
            "dockerPassword": ...
        - pattern: |
            "DOCKER_PASSWORD": ...
        - pattern: |
            "docker_hub_password": ...
      
      # ==================== OAUTH & SSO ====================
      
      # OAuth
      - pattern-either:
        - pattern: |
            "oauth_token": ...
        - pattern: |
            "oauthToken": ...
        - pattern: |
            "OAUTH_TOKEN": ...
        - pattern: |
            "oauth_secret": ...
        - pattern: |
            "oauthSecret": ...
        - pattern: |
            "OAUTH_SECRET": ...
      
      # Firebase
      - pattern-either:
        - pattern: |
            "firebase_api_key": ...
        - pattern: |
            "firebaseApiKey": ...
        - pattern: |
            "FIREBASE_API_KEY": ...
        - pattern: |
            "firebase_server_key": ...
      
      # Auth0
      - pattern-either:
        - pattern: |
            "auth0_client_secret": ...
        - pattern: |
            "auth0ClientSecret": ...
        - pattern: |
            "AUTH0_CLIENT_SECRET": ...
      
      # Okta
      - pattern-either:
        - pattern: |
            "okta_token": ...
        - pattern: |
            "oktaToken": ...
        - pattern: |
            "OKTA_TOKEN": ...
      
      # ==================== ENCRYPTION & SIGNING ====================
      
      # Private Keys
      - pattern-either:
        - pattern: |
            "private_key": ...
        - pattern: |
            "privateKey": ...
        - pattern: |
            "PRIVATE_KEY": ...
        - pattern: |
            "rsa_private_key": ...
        - pattern: |
            "RSA_PRIVATE_KEY": ...
      
      # Encryption Keys
      - pattern-either:
        - pattern: |
            "encryption_key": ...
        - pattern: |
            "encryptionKey": ...
        - pattern: |
            "ENCRYPTION_KEY": ...
        - pattern: |
            "master_key": ...
        - pattern: |
            "masterKey": ...
        - pattern: |
            "MASTER_KEY": ...
      
      # JWT Secrets
      - pattern-either:
        - pattern: |
            "jwt_secret": ...
        - pattern: |
            "jwtSecret": ...
        - pattern: |
            "JWT_SECRET": ...
        - pattern: |
            "jwt_key": ...
        - pattern: |
            "JWT_KEY": ...
      
      # Signing Keys
      - pattern-either:
        - pattern: |
            "signing_key": ...
        - pattern: |
            "signingKey": ...
        - pattern: |
            "SIGNING_KEY": ...
      
      # ==================== PAYMENT PROVIDERS ====================
      
      # PayPal
      - pattern-either:
        - pattern: |
            "paypal_secret": ...
        - pattern: |
            "paypalSecret": ...
        - pattern: |
            "PAYPAL_SECRET": ...
        - pattern: |
            "paypal_client_secret": ...
      
      # Square
      - pattern-either:
        - pattern: |
            "square_access_token": ...
        - pattern: |
            "squareAccessToken": ...
        - pattern: |
            "SQUARE_ACCESS_TOKEN": ...
      
      # Braintree
      - pattern-either:
        - pattern: |
            "braintree_private_key": ...
        - pattern: |
            "braintreePrivateKey": ...
        - pattern: |
            "BRAINTREE_PRIVATE_KEY": ...
      
      # ==================== MISCELLANEOUS ====================
      
      # Session Secrets
      - pattern-either:
        - pattern: |
            "session_secret": ...
        - pattern: |
            "sessionSecret": ...
        - pattern: |
            "SESSION_SECRET": ...
      
      # Cookie Secrets
      - pattern-either:
        - pattern: |
            "cookie_secret": ...
        - pattern: |
            "cookieSecret": ...
        - pattern: |
            "COOKIE_SECRET": ...
      
      # Webhook Secrets
      - pattern-either:
        - pattern: |
            "webhook_secret": ...
        - pattern: |
            "webhookSecret": ...
        - pattern: |
            "WEBHOOK_SECRET": ...
      
      # SSH Keys
      - pattern-either:
        - pattern: |
            "ssh_key": ...
        - pattern: |
            "sshKey": ...
        - pattern: |
            "SSH_KEY": ...
        - pattern: |
            "ssh_private_key": ...
      
      # Certificates
      - pattern-either:
        - pattern: |
            "certificate": ...
        - pattern: |
            "cert": ...
        - pattern: |
            "ssl_certificate": ...
        - pattern: |
            "sslCertificate": ...
      
      # API Endpoints with credentials
      - pattern-either:
        - pattern: |
            "api_url": ...
        - pattern: |
            "apiUrl": ...
        - pattern: |
            "base_url": ...
        - pattern: |
            "baseUrl": ...
      
      # Credentials generic
      - pattern-either:
        - pattern: |
            "credentials": ...
        - pattern: |
            "credential": ...
        - pattern: |
            "auth": ...
        - pattern: |
            "authorization": ...
      
      # ==================== ANALYTICS & TRACKING ====================
      
      # Google Analytics
      - pattern-either:
        - pattern: |
            "ga_tracking_id": ...
        - pattern: |
            "google_analytics_key": ...
      
      # Segment
      - pattern-either:
        - pattern: |
            "segment_write_key": ...
        - pattern: |
            "segmentWriteKey": ...
        - pattern: |
            "SEGMENT_WRITE_KEY": ...
      
      # Mixpanel
      - pattern-either:
        - pattern: |
            "mixpanel_token": ...
        - pattern: |
            "mixpanelToken": ...
        - pattern: |
            "MIXPANEL_TOKEN": ...
      
      # ==================== CI/CD ====================
      
      # Jenkins
      - pattern-either:
        - pattern: |
            "jenkins_token": ...
        - pattern: |
            "jenkinsToken": ...
        - pattern: |
            "JENKINS_TOKEN": ...
      
      # CircleCI
      - pattern-either:
        - pattern: |
            "circle_token": ...
        - pattern: |
            "circleToken": ...
        - pattern: |
            "CIRCLE_TOKEN": ...
      
      # Travis
      - pattern-either:
        - pattern: |
            "travis_token": ...
        - pattern: |
            "travisToken": ...
        - pattern: |
            "TRAVIS_TOKEN": ...
      
      # ==================== MESSAGING & COMMUNICATION ====================
      
      # Telegram
      - pattern-either:
        - pattern: |
            "telegram_bot_token": ...
        - pattern: |
            "telegramBotToken": ...
        - pattern: |
            "TELEGRAM_BOT_TOKEN": ...
      
      # Discord
      - pattern-either:
        - pattern: |
            "discord_token": ...
        - pattern: |
            "discordToken": ...
        - pattern: |
            "DISCORD_TOKEN": ...
        - pattern: |
            "discord_webhook": ...
      
      # WhatsApp Business
      - pattern-either:
        - pattern: |
            "whatsapp_token": ...
        - pattern: |
            "whatsappToken": ...
        - pattern: |
            "WHATSAPP_TOKEN": ...
      
      # ==================== MONITORING & LOGGING ====================
      
      # Sentry
      - pattern-either:
        - pattern: |
            "sentry_dsn": ...
        - pattern: |
            "sentryDsn": ...
        - pattern: |
            "SENTRY_DSN": ...
        - pattern: |
            "sentry_auth_token": ...
      
      # Datadog
      - pattern-either:
        - pattern: |
            "datadog_api_key": ...
        - pattern: |
            "datadogApiKey": ...
        - pattern: |
            "DATADOG_API_KEY": ...
      
      # New Relic
      - pattern-either:
        - pattern: |
            "new_relic_license_key": ...
        - pattern: |
            "newRelicLicenseKey": ...
        - pattern: |
            "NEW_RELIC_LICENSE_KEY": ...
      
      # ==================== CDN & STORAGE ====================
      
      # Cloudflare
      - pattern-either:
        - pattern: |
            "cloudflare_api_key": ...
        - pattern: |
            "cloudflareApiKey": ...
        - pattern: |
            "CLOUDFLARE_API_KEY": ...
      
      # Amazon S3
      - pattern-either:
        - pattern: |
            "s3_secret_key": ...
        - pattern: |
            "s3SecretKey": ...
        - pattern: |
            "S3_SECRET_KEY": ...
        - pattern: |
            "s3_access_key": ...
      
      # ==================== SPECIFIC PLATFORMS ====================
      
      # Shopify
      - pattern-either:
        - pattern: |
            "shopify_api_key": ...
        - pattern: |
            "shopifyApiKey": ...
        - pattern: |
            "SHOPIFY_API_KEY": ...
        - pattern: |
            "shopify_password": ...
      
      # WordPress
      - pattern-either:
        - pattern: |
            "wp_api_key": ...
        - pattern: |
            "wpApiKey": ...
        - pattern: |
            "WP_API_KEY": ...
      
      # Salesforce
      - pattern-either:
        - pattern: |
            "salesforce_token": ...
        - pattern: |
            "salesforceToken": ...
        - pattern: |
            "SALESFORCE_TOKEN": ...
      
      # Jira
      - pattern-either:
        - pattern: |
            "jira_token": ...
        - pattern: |
            "jiraToken": ...
        - pattern: |
            "JIRA_TOKEN": ...
      
      # Confluence
      - pattern-either:
        - pattern: |
            "confluence_token": ...
        - pattern: |
            "confluenceToken": ...
        - pattern: |
            "CONFLUENCE_TOKEN": ...

    metadata:
      category: security
      subcategory:
        - audit
      cwe:
        - "CWE-798: Use of Hard-coded Credentials"
        - "CWE-259: Use of Hard-coded Password"
        - "CWE-321: Use of Hard-coded Cryptographic Key"
        - "CWE-540: Inclusion of Sensitive Information in Source Code"
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: MEDIUM
      references:
        - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
        - https://cwe.mitre.org/data/definitions/798.html
        - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html