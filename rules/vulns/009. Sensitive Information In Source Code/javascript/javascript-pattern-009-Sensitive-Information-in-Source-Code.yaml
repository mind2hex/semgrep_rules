rules:
  - id: javascript-pattern-009-sensitive-information-in-source-code
    languages:
      - javascript
      - typescript
    severity: INFO
    paths:
      exclude:
        # Mocks (en cualquier directorio)
        - "**/*.mock.*"
        - "**/__mocks__/**"

        # Tests por nombre de archivo (Jest/Vitest/Mocha)
        - "**/*.test.*"
        - "**/*.spec.*"
        - "**/*.unit.*"
        - "**/*.integration.*"
        - "**/*.e2e.*"

        # Directorios t√≠picos de tests
        - "**/__tests__/**"
        - "**/test/**"
        - "**/tests/**"
        - "**/testing/**"

        # Frameworks e2e comunes
        - "**/cypress/**"
        - "**/playwright/**"

        # Snapshots
        - "**/__snapshots__/**"

        # (Opcional) Artefactos de build
        - "**/dist/**"
        - "**/build/**"
        - "**/coverage/**"
        - "**/node_modules/**"

    message: The source code repository contains sensitive information such as
      usernames, passwords, email addresses and IP addresses, amon  g others.
      Alternatively, while values may be password=123 o aws.secret_key=test,
      they reveal the bad practice of storing sensitive information in the
      repository with no encryption, and sooner or later they can be replaced
      for real sensitive values.
    pattern-either:
      - patterns:
        - pattern-inside: |
            $FOO = {
              ...
            }
        - pattern: |
            $STR: "..."
        - pattern-not: |
            $STR: {...}
        - pattern-not: |
            $STR: ''
        - metavariable-regex:
            metavariable: $STR
            regex: (user|username|pass|password|database|server)