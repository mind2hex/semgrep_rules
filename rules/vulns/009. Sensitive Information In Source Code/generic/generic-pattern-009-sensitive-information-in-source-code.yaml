rules:
  - id: generic-pattern-009-sensitive-information-in-source-code
    languages:
      - generic
    severity: WARNING
    message: The source code repository contains sensitive information such as
      usernames, passwords, email addresses and IP addresses, among others.
      Alternatively, while values may be password=123 o aws.secret_key=test,
      they reveal the bad practice of storing sensitive information in the
      repository with no encryption, and sooner or later they can be replaced
      for real sensitive values.
    pattern-either:
      # SAS keys https://learn.microsoft.com/en-us/community/content/secure-integration-workflows-azure-logic-apps-api-management?utm_source=chatgpt.com
      - pattern-regex: https://.*&sig=.*

      # gmail found
      - pattern-regex: \b[a-zA-Z0-9][a-zA-Z0-9._%+-]*@gmail\.com\b

      #  aws cloud platform credentials
      - pattern-regex: cloud.auth.aws_.*

      # .properties secrets
      - pattern-regex: spring.datasource.(url|password|username)=.*

    metadata:
      category: security
      subcategory:
        - audit
      cwe:
        - "CWE-540: Inclusion of Sensitive Information in Source Code"
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: MEDIUM
