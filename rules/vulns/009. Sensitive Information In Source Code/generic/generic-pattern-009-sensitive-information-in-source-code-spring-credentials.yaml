rules:
  - id: generic-pattern-009-sensitive-information-in-source-code-spring-credentials
    languages: [generic]
    severity: WARNING
    message: >-
      **Possible Sensitive Configuration Found in .properties File**
      This finding indicates that a **Spring `.properties` file** may contain
      **sensitive information** such as database credentials or connection URLs.
    paths:
      include:
        - "*.properties"
        - "**/*.properties"
    patterns:
      - pattern-regex: |
          spring\.datasource\.(url|username|password)\s*=\s*[^\r\n]+
      - pattern-not-regex: |
          spring\.datasource\.(url|username|password)\s*=\s*\$\{[^}]+\}\s*(?:#.*)?(?:\r?\n|$)
    metadata:
      category: security
      subcategory: [audit]
      cwe: ["CWE-540: Inclusion of Sensitive Information in Source Code"]
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: MEDIUM
      references:
        - https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config
        - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
