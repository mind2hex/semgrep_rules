rules:
  - id: generic-pattern-009-sensitive-information-in-source-code-java-keystores
    languages:
      - generic
    severity: WARNING
    message: >-
      **Potential Sensitive Configuration Detected in Spring `.properties` File**

      This rule detected a configuration entry related to a **Java keystore**
      (`keystorePath` or `keystorePassword`) inside a Spring `.properties` file.

      Use the following command to view the content of the keytool:
        `keytool -list -keystore {/keystore/path} -storepass {password}`
    pattern-regex: certificate\.(keystorePath|keystorePassword)\s*=\s*.*
    metadata:
      category: security
      subcategory:
        - audit
      cwe:
        - "CWE-540: Inclusion of Sensitive Information in Source Code"
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: MEDIUM
      references:
        - https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config
        - https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html
