rules:
  - id: java-tainted-100-server-side-request-forgery-ssrf
    languages:
      - java
    severity: HIGH
    message: >
      It is possible to induce the application's server into making requests to
      an arbitrary domain.
    mode: taint
    pattern-sources:
      - pattern: getAuthenticationRequest().getRequestURI()
      - patterns:
          - pattern: |
              $RETURNTYPE $FUNCTION(..., $SOURCE, ...){...}
          - focus-metavariable: $SOURCE
    pattern-sinks:
      - pattern: new HttpGet(...);
      - pattern: new UrlResource(...);
      - patterns:
          - pattern-inside: new UrlResource(...); ...
          - pattern: $FOO.getContentAsString(...);
          - focus-metavariable: $FOO
    metadata:
      category: security
      subcategory:
        - vuln
      cwe:
        - "CWE-918: Server-Side Request Forgery (SSRF)"
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: MEDIUM
      owasp:
        - A10:2021 Server-Side Request Forgery (SSRF)
      references:
        - https://pentesterlab.com/exercises/cve-2022-x41x9
        - https://pentesterlab.com/exercises/java-code-review-12
