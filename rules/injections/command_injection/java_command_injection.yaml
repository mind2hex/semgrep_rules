rules:
  - id: java.command_execution
    languages: [java]
    message: "Posible ejecuci√≥n de comando del sistema"
    severity: CRITICAL
    pattern-either:
      # Runtime.getRuntime
      - patterns:
          - pattern: Runtime.getRuntime().exec(..., $OBJ, ...)

      # ProcessBuildeer
      - patterns:
          - pattern: |
              ProcessBuilder $FOO = new ProcessBuilder(...);
              ...
              $FOO.start();
      - pattern: new ProcessBuilder().command(..., $OBJ, ...).start()

      # DefaultExecutor
      - patterns: 
          - pattern: |
              new DefaultExecutor().execute(..., $OBJ, ...)
          - pattern-not: |
              new DefaultExecutor().execute("...")

      # CommandLine
      - patterns: 
          - pattern: | 
              CommandLineUtils.executeCommandLine(..., $OBJ, ...)
          - pattern-not: |
              CommandLineUtils.executeCommandLine("...")
      - pattern: new ProcessExecutor(...).start()