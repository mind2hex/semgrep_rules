rules:
  - id: java-tainted-log-injection
    languages:
      - java
    severity: ERROR
    message: |
      Semgrep found a possibly log injection vulnerability using taint analysis
      in the source code.
    mode: taint
    pattern-sources:
      - patterns:
          - pattern: |
              $RETURNTYPE $FUNCTION(..., $OBJ, ...){
                ...
              }
          - focus-metavariable: $OBJ
    pattern-sinks:
      - patterns:
          - pattern: $LOGGER.$METHOD(...);
          - metavariable-regex:
              metavariable: $LOGGER
              regex: (?i)(log|logger|logging)
          - metavariable-regex:
              metavariable: $METHOD
              regex: (?i)(info|debug|warning)
    metadata:
      category: security
      subcategory:
        - vuln
      cwe:
        - "CWE-74: Improper Neutralization of Special Elements in Output Used by
          a Downstream Component ('Injection')"
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: LOW
      owasp:
        - A3:2021 Injection
      technology:
        - springframework
